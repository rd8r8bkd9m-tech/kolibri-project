#!/bin/bash

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘     ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ Ğ’ĞĞ¨Ğ•Ğ“Ğ Ğ Ğ•ĞĞ›Ğ¬ĞĞĞ“Ğ Ğ¡ĞšĞ Ğ˜ĞĞ¨ĞĞ¢Ğ                       â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
if [ ! -f "user_screenshot.png" ]; then
    echo "âŒ Ğ¤Ğ°Ğ¹Ğ» user_screenshot.png Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½"
    echo "ğŸ’¡ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚Ğµ Ğ²Ğ°Ñˆ ÑĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ ĞºĞ°Ğº user_screenshot.png Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ ÑĞ½Ğ¾Ğ²Ğ°"
    exit 1
fi

echo "ğŸ“¸ ĞĞ°Ğ¹Ğ´ĞµĞ½ ÑĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚: user_screenshot.png"
ls -lh user_screenshot.png

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "Ğ¨ĞĞ“ 1: ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

# ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€
SIZE=$(stat -f%z user_screenshot.png 2>/dev/null || stat -c%s user_screenshot.png 2>/dev/null)
echo "   Ğ Ğ°Ğ·Ğ¼ĞµÑ€: $SIZE bytes"

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚
if file user_screenshot.png | grep -q "PNG"; then
    echo "   Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: âœ… PNG"
elif file user_screenshot.png | grep -q "JPEG"; then
    echo "   Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: âœ… JPEG"
else
    echo "   Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: âš ï¸  $(file user_screenshot.png | cut -d: -f2)"
fi

# ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ğ´Ğ»Ñ Ğ´ĞµĞ¼Ğ¾ (Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ 5KB)
PROCESS_SIZE=$SIZE
if [ $SIZE -gt 5120 ]; then
    PROCESS_SIZE=5120
    echo "   ğŸ’¡ Ğ”Ğ»Ñ Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµĞ¼ Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ 5KB"
fi

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "Ğ¨ĞĞ“ 2: Ğ—Ğ°Ğ¿ÑƒÑĞº decimal encoding"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

# Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ½Ğ°Ñˆ Ñ‚ĞµÑÑ‚
if [ -f "./build/test_image_processing" ]; then
    echo "ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ test_image_processing..."
    ./build/test_image_processing user_screenshot.png
else
    echo "âš ï¸  test_image_processing Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ñ‚ĞµÑÑ‚..."
    if [ -f "./test_real_image" ]; then
        # Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾ ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµĞ¼ Ğ´Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸
        cp user_screenshot.png test_image.png
        ./test_real_image
        mv test_image.png user_screenshot.png
        
        # ĞŸĞµÑ€ĞµĞ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
        if [ -f "image_encoded.txt" ]; then
            mv image_encoded.txt user_screenshot_encoded.txt
            echo ""
            echo "âœ… Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ñ‹:"
            echo "   â€¢ user_screenshot_encoded.txt"
        fi
        if [ -f "image_restored.png" ]; then
            mv image_restored.png user_screenshot_restored.png
            echo "   â€¢ user_screenshot_restored.png"
        fi
    else
        echo "âŒ Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹"
        echo "ğŸ’¡ Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ: gcc test_real_image.c -o test_real_image"
    fi
fi

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘                    Ğ“ĞĞ¢ĞĞ’Ğ!                                     â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

