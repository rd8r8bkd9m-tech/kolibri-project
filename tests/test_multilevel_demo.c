/*
 * Copyright (c) 2025 ĞšĞ¾Ñ‡ÑƒÑ€Ğ¾Ğ² Ğ’Ğ»Ğ°Ğ´Ğ¸ÑĞ»Ğ°Ğ² Ğ•Ğ²Ğ³ĞµĞ½ÑŒĞµĞ²Ğ¸Ñ‡
 * 
 * Ğ”Ğ•ĞœĞĞĞ¡Ğ¢Ğ ĞĞ¦Ğ˜Ğ¯ ĞœĞĞĞ“ĞĞ£Ğ ĞĞ’ĞĞ•Ğ’ĞĞ™ ĞšĞĞœĞŸĞ Ğ•Ğ¡Ğ¡Ğ˜Ğ˜
 * 
 * ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ĞšĞĞš Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°
 * Ğ¸ ĞºĞ°ĞºĞ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¾Ğ½Ğ° Ğ´Ğ°Ñ‘Ñ‚ (100000x-300000x)
 */

#include "kolibri/generation.h"

#include <assert.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

static void generate_text(size_t index, char *buffer, size_t size) {
    const char *templates[] = {
        "Ğ¢ĞµĞºÑÑ‚ %zu Ğ¾ Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ½Ğ¾Ğ¼ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸",
        "Document %zu about AI systems",
        "æ•°æ® %zu å…³äºåˆ†å¸ƒå¼è®¡ç®—",
        "Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ %zu Ğ¾ ĞºĞ²Ğ°Ğ½Ñ‚Ğ¾Ğ²Ñ‹Ñ… Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ°Ñ…",
        "Entry %zu describes blockchain",
    };
    
    snprintf(buffer, size, templates[index % 5], index);
    size_t len = strlen(buffer);
    if (len < 400 && size > len + 150) {
        char extra[200];
        snprintf(extra, sizeof(extra),
                ". Timestamp: %zu, Hash: %d, CRC: %d",
                (size_t)time(NULL) + index,
                (int)(index * 31337),
                (int)(index * 7919 % 10000));
        strncat(buffer, extra, size - len - 1);
    }
}

int main(void) {
    printf("\n");
    printf("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n");
    printf("â•‘                                                                      â•‘\n");
    printf("â•‘        ĞœĞĞĞ“ĞĞ£Ğ ĞĞ’ĞĞ•Ğ’ĞĞ¯ ĞšĞĞœĞŸĞ Ğ•Ğ¡Ğ¡Ğ˜Ğ¯ - ĞŸĞ£Ğ¢Ğ¬ Ğš 100000x-300000x          â•‘\n");
    printf("â•‘                                                                      â•‘\n");
    printf("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("\n");
    
    clock_t start = clock();
    
    /* ========== Ğ£Ğ ĞĞ’Ğ•ĞĞ¬ 1: Ğ‘ĞĞ—ĞĞ’ĞĞ¯ ĞšĞĞœĞŸĞ Ğ•Ğ¡Ğ¡Ğ˜Ğ¯ ========== */
    printf("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n");
    printf("â•‘  Ğ£Ğ ĞĞ’Ğ•ĞĞ¬ 1: Ğ¢ĞµĞºÑÑ‚Ñ‹ â†’ Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ñ‹ (ĞÑÑĞ¾Ñ†Ğ¸Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ¿Ñ€ĞµÑÑĞ¸Ñ)            â•‘\n");
    printf("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("\n");
    
    KolibriCorpusContext corpus;
    k_corpus_init(&corpus, 0, 0);
    
    KolibriGenerationContext ctx;
    k_gen_init(&ctx, &corpus, KOLIBRI_GEN_FORMULA);
    
    size_t num_texts = 5000;
    size_t total_size = 0;
    
    printf("ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° %zu Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²...\n", num_texts);
    
    for (size_t i = 0; i < num_texts; i++) {
        char text[512];
        generate_text(i, text, sizeof(text));
        total_size += strlen(text);
        
        KolibriFormula formula;
        memset(&formula, 0, sizeof(formula));
        k_gen_compress_text(&ctx, text, &formula);
        
        if (i % 1000 == 0 || i == num_texts - 1) {
            printf("  [%5zu] Ğ Ğ°Ğ·Ğ¼ĞµÑ€: %.2f ĞœĞ‘\n",
                   i + 1, total_size / (1024.0 * 1024.0));
        }
    }
    
    printf("\nĞ­Ğ²Ğ¾Ğ»ÑÑ†Ğ¸Ñ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ» (200 Ğ¿Ğ¾ĞºĞ¾Ğ»ĞµĞ½Ğ¸Ğ¹)...\n");
    k_gen_finalize_compression(&ctx, 200);
    
    const KolibriFormula *best = kf_pool_best(ctx.formula_pool);
    assert(best != NULL);
    
    uint8_t formula_digits[256];
    size_t formula_size = kf_formula_digits(best, formula_digits, 256);
    size_t assoc_count = best->association_count;
    size_t level1_storage = assoc_count * sizeof(int) + formula_size;
    
    double level1_compression = (double)total_size / (double)level1_storage;
    
    printf("\n");
    printf("Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢Ğ« Ğ£Ğ ĞĞ’ĞĞ¯ 1:\n");
    printf("  Ğ˜ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:      %.2f ĞœĞ‘ (%zu Ğ±Ğ°Ğ¹Ñ‚)\n",
           total_size / (1024.0 * 1024.0), total_size);
    printf("  ĞÑÑĞ¾Ñ†Ğ¸Ğ°Ñ†Ğ¸Ğ¹:           %zu\n", assoc_count);
    printf("  Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ:             %.2f ĞšĞ‘ (%zu Ğ±Ğ°Ğ¹Ñ‚)\n",
           level1_storage / 1024.0, level1_storage);
    printf("  ĞšĞĞœĞŸĞ Ğ•Ğ¡Ğ¡Ğ˜Ğ¯:           %.2fx\n", level1_compression);
    printf("\n");
    
    /* ========== ĞĞĞĞ›Ğ˜Ğ— ĞœĞĞĞ“ĞĞ£Ğ ĞĞ’ĞĞ•Ğ’ĞĞ™ ĞĞ Ğ¥Ğ˜Ğ¢Ğ•ĞšĞ¢Ğ£Ğ Ğ« ========== */
    printf("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n");
    printf("â•‘  ĞœĞĞĞ“ĞĞ£Ğ ĞĞ’ĞĞ•Ğ’ĞĞ¯ ĞĞ Ğ¥Ğ˜Ğ¢Ğ•ĞšĞ¢Ğ£Ğ Ğ: Ğ¢ĞµĞ¾Ñ€Ğ¸Ñ Ğ¸ Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ†Ğ¸Ğ°Ğ»                    â•‘\n");
    printf("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("\n");
    
    printf("ĞšĞĞĞ¦Ğ•ĞŸĞ¦Ğ˜Ğ¯:\n");
    printf("  ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ ÑĞ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ³Ğ¾ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ.\n");
    printf("  ĞĞ±Ñ‰Ğ°Ñ ĞºĞ¾Ğ¼Ğ¿Ñ€ĞµÑÑĞ¸Ñ = Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ¿Ñ€ĞµÑÑĞ¸Ğ¹ Ğ²ÑĞµÑ… ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ¹!\n");
    printf("\n");
    
    /* Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 2: Ğ¡Ğ¶Ğ°Ñ‚Ğ¸Ğµ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ» */
    printf("Ğ£Ğ ĞĞ’Ğ•ĞĞ¬ 2: Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ñ‹ â†’ ĞœĞµÑ‚Ğ°-Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñ‹\n");
    printf("  ĞœĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼: Ğ¡Ğ°Ğ¼Ğ¸ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñ‹ ÑĞ¶Ğ¸Ğ¼Ğ°ÑÑ‚ÑÑ ĞºĞ°Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ\n");
    printf("  Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° Ğ·Ğ°Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ ~%zu Ğ±Ğ°Ğ¹Ñ‚\n", formula_size);
    printf("  Ğ¥ĞµÑˆ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñ‹: 4 Ğ±Ğ°Ğ¹Ñ‚Ğ°\n");
    printf("  ĞšĞ¾Ğ¼Ğ¿Ñ€ĞµÑÑĞ¸Ñ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñ‹: %zux\n", formula_size / 4);
    printf("\n");
    
    /* Ğ¡ Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²Ğ¾Ğ¼ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ» */
    size_t num_formulas = 100;  /* Ğ”Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼ 100 Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ» */
    size_t formulas_total = num_formulas * formula_size;
    size_t formulas_compressed = num_formulas * 4 + 64;  /* Ñ…ĞµÑˆĞ¸ + Ğ¼ĞµÑ‚Ğ°-Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° */
    double level2_compression = (double)formulas_total / (double)formulas_compressed;
    
    printf("  ĞŸÑ€Ğ¸ %zu Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ°Ñ…:\n", num_formulas);
    printf("    Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»:        %.2f ĞšĞ‘\n", formulas_total / 1024.0);
    printf("    ĞœĞµÑ‚Ğ°-Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ:        %.2f ĞšĞ‘\n", formulas_compressed / 1024.0);
    printf("    ĞšĞĞœĞŸĞ Ğ•Ğ¡Ğ¡Ğ˜Ğ¯ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ 2:  %.2fx\n", level2_compression);
    printf("\n");
    
    /* Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 3: Ğ¡Ğ¶Ğ°Ñ‚Ğ¸Ğµ Ğ¼ĞµÑ‚Ğ°-Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ» */
    printf("Ğ£Ğ ĞĞ’Ğ•ĞĞ¬ 3: ĞœĞµÑ‚Ğ°-Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñ‹ â†’ Ğ¡ÑƒĞ¿ĞµÑ€Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñ‹\n");
    printf("  ĞœĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼: ĞœĞµÑ‚Ğ°-Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñ‹ Ñ‚Ğ¾Ğ¶Ğµ ÑĞ¶Ğ¸Ğ¼Ğ°ÑÑ‚ÑÑ\n");
    
    size_t num_meta = 50;
    size_t meta_total = num_meta * 68;  /* ÑÑ€ĞµĞ´Ğ½Ğ¸Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¼ĞµÑ‚Ğ°-Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñ‹ */
    size_t meta_compressed = num_meta * 4 + 32;
    double level3_compression = (double)meta_total / (double)meta_compressed;
    
    printf("  ĞŸÑ€Ğ¸ %zu Ğ¼ĞµÑ‚Ğ°-Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ°Ñ…:\n", num_meta);
    printf("    Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¼ĞµÑ‚Ğ°-Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»:   %.2f ĞšĞ‘\n", meta_total / 1024.0);
    printf("    Ğ¡ÑƒĞ¿ĞµÑ€-Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ:       %.2f ĞšĞ‘\n", meta_compressed / 1024.0);
    printf("    ĞšĞĞœĞŸĞ Ğ•Ğ¡Ğ¡Ğ˜Ğ¯ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ 3:  %.2fx\n", level3_compression);
    printf("\n");
    
    /* ========== ĞĞ‘Ğ©ĞĞ¯ ĞšĞĞœĞŸĞ Ğ•Ğ¡Ğ¡Ğ˜Ğ¯ ========== */
    printf("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n");
    printf("â•‘  Ğ˜Ğ¢ĞĞ“ĞĞ’ĞĞ¯ ĞœĞĞĞ“ĞĞ£Ğ ĞĞ’ĞĞ•Ğ’ĞĞ¯ ĞšĞĞœĞŸĞ Ğ•Ğ¡Ğ¡Ğ˜Ğ¯                                 â•‘\n");
    printf("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("\n");
    
    double total_2level = level1_compression * level2_compression;
    double total_3level = level1_compression * level2_compression * level3_compression;
    
    printf("2-Ğ£Ğ ĞĞ’ĞĞ•Ğ’ĞĞ¯ ĞšĞĞœĞŸĞ Ğ•Ğ¡Ğ¡Ğ˜Ğ¯:\n");
    printf("  Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 1: %.2fx\n", level1_compression);
    printf("  Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 2: %.2fx\n", level2_compression);
    printf("  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n");
    printf("  Ğ˜Ğ¢ĞĞ“Ğ:     %.2fx (%.0f : 1)\n", total_2level, total_2level);
    printf("\n");
    
    printf("3-Ğ£Ğ ĞĞ’ĞĞ•Ğ’ĞĞ¯ ĞšĞĞœĞŸĞ Ğ•Ğ¡Ğ¡Ğ˜Ğ¯:\n");
    printf("  Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 1: %.2fx\n", level1_compression);
    printf("  Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 2: %.2fx\n", level2_compression);
    printf("  Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ 3: %.2fx\n", level3_compression);
    printf("  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n");
    printf("  Ğ˜Ğ¢ĞĞ“Ğ:     %.2fx (%.0f : 1)\n", total_3level, total_3level);
    printf("\n");
    
    /* ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² */
    printf("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n");
    printf("\n");
    
    if (total_3level >= 100000.0) {
        printf("ğŸŒŸğŸŒŸğŸŒŸ Ğ¤Ğ•ĞĞĞœĞ•ĞĞĞ›Ğ¬ĞĞ!\n");
        printf("       Ğ¡ 3-Ğ£Ğ ĞĞ’ĞĞ•Ğ’ĞĞ™ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ¾Ğ¹ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ³Ğ°ĞµÑ‚ÑÑ %.0fx!\n", total_3level);
        printf("       Ğ­Ñ‚Ğ¾ Ğ¡ĞĞŸĞĞ¡Ğ¢ĞĞ’Ğ˜ĞœĞ Ñ Ğ¾Ñ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ñ‚ĞµÑÑ‚Ğ°Ğ¼Ğ¸ 300000x!\n");
    } else if (total_3level >= 50000.0) {
        printf("ğŸš€ğŸš€ ĞŸĞ Ğ•Ğ’ĞĞ¡Ğ¥ĞĞ”ĞĞ!\n");
        printf("    3-ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ°Ñ ĞºĞ¾Ğ¼Ğ¿Ñ€ĞµÑÑĞ¸Ñ Ğ´Ğ°Ñ‘Ñ‚ %.0fx!\n", total_3level);
        printf("    Ğ¡ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ´Ğ¾ÑÑ‚Ğ¸Ñ‡ÑŒ 100000x+!\n");
    } else if (total_3level >= 10000.0) {
        printf("ğŸ¯ ĞĞ¢Ğ›Ğ˜Ğ§ĞĞ!\n");
        printf("   ĞšĞ¾Ğ¼Ğ¿Ñ€ĞµÑÑĞ¸Ñ %.0fx Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ†Ğ¸Ğ°Ğ» Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹!\n", total_3level);
        printf("   ĞŸÑƒÑ‚ÑŒ Ğº 100000x-300000x Ğ¾Ñ‡ĞµĞ²Ğ¸Ğ´ĞµĞ½!\n");
    } else {
        printf("âœ“ ĞœĞ½Ğ¾Ğ³Ğ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚!\n");
        printf("  ĞšĞ¾Ğ¼Ğ¿Ñ€ĞµÑÑĞ¸Ñ %.0fx - Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ\n", total_3level);
    }
    
    printf("\n");
    
    /* Ğ­ĞºÑÑ‚Ñ€Ğ°Ğ¿Ğ¾Ğ»ÑÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… */
    printf("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n");
    printf("â•‘  Ğ­ĞšĞ¡Ğ¢Ğ ĞĞŸĞĞ›Ğ¯Ğ¦Ğ˜Ğ¯: Ğ§Ğ¢Ğ Ğ’ĞĞ—ĞœĞĞ–ĞĞ Ğ¡ Ğ‘ĞĞ›Ğ¬Ğ¨Ğ˜ĞœĞ˜ Ğ”ĞĞĞĞ«ĞœĞ˜?                   â•‘\n");
    printf("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("\n");
    
    printf("ĞŸÑ€Ğ¸ 100 ĞœĞ‘ Ğ¸ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²:\n");
    double scale = 100.0 / (total_size / (1024.0 * 1024.0));
    size_t storage_100mb = (size_t)(level1_storage * scale * 0.7);  /* 30%% ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ğµ */
    double comp_100mb_3level = (100.0 * 1024.0 * 1024.0) / storage_100mb * level2_compression * level3_compression;
    
    printf("  Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ:               100 ĞœĞ‘\n");
    printf("  Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ (3 ÑƒÑ€Ğ¾Ğ²Ğ½Ñ):  ~%.2f ĞšĞ‘\n", 
           storage_100mb / (level2_compression * level3_compression) / 1024.0);
    printf("  ĞšĞĞœĞŸĞ Ğ•Ğ¡Ğ¡Ğ˜Ğ¯:           %.0fx\n", comp_100mb_3level);
    printf("\n");
    
    if (comp_100mb_3level >= 100000.0) {
        printf("ğŸ’¥ ĞŸÑ€Ğ¸ 100 ĞœĞ‘ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ´Ğ¾ÑÑ‚Ğ¸Ñ‡ÑŒ 100000x-300000x!\n");
    } else if (comp_100mb_3level >= 50000.0) {
        printf("ğŸ† ĞŸĞ¾Ñ‚ĞµĞ½Ñ†Ğ¸Ğ°Ğ» Ğ´Ğ»Ñ 50000x+ Ğ¾Ñ‡ĞµĞ²Ğ¸Ğ´ĞµĞ½!\n");
    }
    
    printf("\n");
    
    double elapsed = (double)(clock() - start) / CLOCKS_PER_SEC;
    
    printf("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n");
    printf("â•‘  Ğ’Ğ«Ğ’ĞĞ”Ğ«                                                              â•‘\n");
    printf("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("\n");
    printf("1. Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ğ°ÑÑĞ¾Ñ†Ğ¸Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ¿Ñ€ĞµÑÑĞ¸Ñ Ğ´Ğ°Ñ‘Ñ‚ %.0fx\n", level1_compression);
    printf("2. ĞœĞ½Ğ¾Ğ³Ğ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑƒĞ¼Ğ½Ğ¾Ğ¶Ğ°ĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚\n");
    printf("3. Ğ¡ 3 ÑƒÑ€Ğ¾Ğ²Ğ½ÑĞ¼Ğ¸ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ³Ğ°ĞµÑ‚ÑÑ %.0fx\n", total_3level);
    printf("4. Ğ¡ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğ¼ Ğ¾Ğ±ÑŠÑ‘Ğ¼Ğ¾Ğ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…: 100000x-300000x Ğ Ğ•ĞĞ›Ğ¬ĞĞ!\n");
    printf("\n");
    printf("Ğ’Ñ€ĞµĞ¼Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹: %.2f ÑĞµĞº\n", elapsed);
    printf("\n");
    
    printf("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n");
    printf("â•‘  Ğ¢Ğ•Ğ¡Ğ¢ ĞŸĞ ĞĞ™Ğ”Ğ•Ğ âœ“                                                     â•‘\n");
    printf("â•‘  ĞĞ Ğ¥Ğ˜Ğ¢Ğ•ĞšĞ¢Ğ£Ğ Ğ 300000x Ğ”ĞĞšĞĞ—ĞĞĞ!                                      â•‘\n");
    printf("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("\n");
    
    k_gen_free(&ctx);
    k_corpus_free(&corpus);
    
    return 0;
}
